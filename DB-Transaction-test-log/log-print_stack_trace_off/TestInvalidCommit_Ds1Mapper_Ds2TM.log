2022-08-20 21:20:28.689 [main] INFO  DbUtil.restartDataSources(106) - druidDataSource.restart dataSource1
2022-08-20 21:20:28.689 [main] DEBUG DruidMonitorFilter.connection_close(128) - ### [关闭连接] connThreadId 108 自动提交
SqlSessionInfo{connectionHashCode='40490a90', connThreadId=108, localPort=54350, dataSourceName='ds1', autoCommit=true, serverIP='127.0.0.1', serverPort=3306, dbName='testdb', userName='test', serverVersion='5.5.5-10.0.36-MariaDB'}
2022-08-20 21:20:28.704 [main] INFO  DbUtil.restartDataSources(106) - druidDataSource.restart dataSource2
2022-08-20 21:20:28.704 [main] DEBUG DruidMonitorFilter.connection_close(128) - ### [关闭连接] connThreadId 109 自动提交
SqlSessionInfo{connectionHashCode='4c4f291d', connThreadId=109, localPort=54352, dataSourceName='ds2', autoCommit=true, serverIP='127.0.0.1', serverPort=3306, dbName='testdb', userName='test', serverVersion='5.5.5-10.0.36-MariaDB'}
2022-08-20 21:20:28.767 [Druid-ConnectionPool-Create-1620459733] DEBUG DruidMonitorFilter.connection_connectAfter(93) - ### [创建连接] connThreadId 110 自动提交
SqlSessionInfo{connectionHashCode='139098f0', connThreadId=110, localPort=54353, dataSourceName='null', autoCommit=true, serverIP='127.0.0.1', serverPort=3306, dbName='testdb', userName='test', serverVersion='5.5.5-10.0.36-MariaDB'}
2022-08-20 21:20:28.767 [Druid-ConnectionPool-Create-1620459733] DEBUG DruidMonitorFilter.selectProcessList(272) - 
processlist ID [110] USER [test] HOST [localhost:54353] DB [testdb] COMMAND [Query] INFO [select * from information_schema.processlist where id = CONNECTION_ID()]
2022-08-20 21:20:28.767 [main] DEBUG DruidMonitorFilter.dataSource_getConnection(71) - ### [从连接池借出连接] connThreadId 110 dataSourceName ds2
SqlSessionInfo{connectionHashCode='139098f0', connThreadId=110, localPort=54353, dataSourceName='ds2', autoCommit=true, serverIP='127.0.0.1', serverPort=3306, dbName='testdb', userName='test', serverVersion='5.5.5-10.0.36-MariaDB'}
2022-08-20 21:20:28.767 [main] DEBUG DruidMonitorFilter.connection_setAutoCommit(242) - ### [关闭自动提交] connThreadId 110 自动提交
SqlSessionInfo{connectionHashCode='139098f0', connThreadId=110, localPort=54353, dataSourceName='ds2', autoCommit=true, serverIP='127.0.0.1', serverPort=3306, dbName='testdb', userName='test', serverVersion='5.5.5-10.0.36-MariaDB'}
2022-08-20 21:20:28.783 [main] INFO  TransactionService.doOperate(112) - 是否开启事务 是
2022-08-20 21:20:28.814 [Druid-ConnectionPool-Create-1527152775] DEBUG DruidMonitorFilter.connection_connectAfter(93) - ### [创建连接] connThreadId 111 自动提交
SqlSessionInfo{connectionHashCode='5cadc693', connThreadId=111, localPort=54354, dataSourceName='null', autoCommit=true, serverIP='127.0.0.1', serverPort=3306, dbName='testdb', userName='test', serverVersion='5.5.5-10.0.36-MariaDB'}
2022-08-20 21:20:28.814 [Druid-ConnectionPool-Create-1527152775] DEBUG DruidMonitorFilter.selectProcessList(272) - 
processlist ID [111] USER [test] HOST [localhost:54354] DB [testdb] COMMAND [Query] INFO [select * from information_schema.processlist where id = CONNECTION_ID()]
2022-08-20 21:20:28.829 [main] DEBUG DruidMonitorFilter.dataSource_getConnection(71) - ### [从连接池借出连接] connThreadId 111 dataSourceName ds1
SqlSessionInfo{connectionHashCode='5cadc693', connThreadId=111, localPort=54354, dataSourceName='ds1', autoCommit=true, serverIP='127.0.0.1', serverPort=3306, dbName='testdb', userName='test', serverVersion='5.5.5-10.0.36-MariaDB'}
2022-08-20 21:20:28.829 [main] DEBUG DruidMonitorFilter.statementExecuteBefore(158) - ### [执行SQL语句] connThreadId 111 自动提交
select
        task_name, lock_flag, begin_time, end_time, process_info, now() as db_current_date
        from task_lock
        where task_name = ? for update
SqlSessionInfo{connectionHashCode='5cadc693', connThreadId=111, localPort=54354, dataSourceName='ds1', autoCommit=true, serverIP='127.0.0.1', serverPort=3306, dbName='testdb', userName='test', serverVersion='5.5.5-10.0.36-MariaDB'}
2022-08-20 21:20:28.829 [main] DEBUG DruidMonitorFilter.statementExecuteBefore(159) - 当前已开启事务
2022-08-20 21:20:28.829 [main] DEBUG DruidMonitorFilter.statementExecuteBefore(166) - @@@ 执行SQL语句的连接ID（MySQL服务线程ID）与开启事务时的不同 111@[ds1] 110@[ds2]
2022-08-20 21:20:28.845 [main] INFO  TransactionService.doOperate(116) - 查询到的数据 TaskLock{taskName='TEST_DB_TRANSACTION', lockFlag=1, beginTime=Sat Aug 20 21:16:42 CST 2022, endTime=null, dbCurrentDate=Sat Aug 20 21:20:28 CST 2022, processInfo='20180@hostname'}
2022-08-20 21:20:28.861 [main] DEBUG DruidMonitorFilter.statementExecuteBefore(158) - ### [执行SQL语句] connThreadId 111 自动提交
update task_lock
        set
        lock_flag = ?,
        begin_time = now(),
        process_info = ?
        where task_name = ?
SqlSessionInfo{connectionHashCode='5cadc693', connThreadId=111, localPort=54354, dataSourceName='ds1', autoCommit=true, serverIP='127.0.0.1', serverPort=3306, dbName='testdb', userName='test', serverVersion='5.5.5-10.0.36-MariaDB'}
2022-08-20 21:20:28.861 [main] DEBUG DruidMonitorFilter.statementExecuteBefore(159) - 当前已开启事务
2022-08-20 21:20:28.861 [main] DEBUG DruidMonitorFilter.statementExecuteBefore(166) - @@@ 执行SQL语句的连接ID（MySQL服务线程ID）与开启事务时的不同 111@[ds1] 110@[ds2]
2022-08-20 21:20:28.861 [main] INFO  TransactionService.doOperate(125) - 修改记录状态为锁定，更新行数 1 TEST_DB_TRANSACTION
2022-08-20 21:20:28.861 [main] INFO  TransactionService.run(107) - 执行结果 true
2022-08-20 21:20:28.861 [main] DEBUG DruidMonitorFilter.dataSource_releaseConnection(109) - ### [归还连接至连接池] connThreadId 111 自动提交 当前连接SQL语句执行次数: 2
SqlSessionInfo{connectionHashCode='5cadc693', connThreadId=111, localPort=54354, dataSourceName='ds1', autoCommit=true, serverIP='127.0.0.1', serverPort=3306, dbName='testdb', userName='test', serverVersion='5.5.5-10.0.36-MariaDB'}
2022-08-20 21:20:28.861 [main] DEBUG DruidMonitorFilter.connection_commit(188) - ### [提交事务] connThreadId 110 不自动提交 当前连接SQL语句执行次数: 0
SqlSessionInfo{connectionHashCode='139098f0', connThreadId=110, localPort=54353, dataSourceName='ds2', autoCommit=false, serverIP='127.0.0.1', serverPort=3306, dbName='testdb', userName='test', serverVersion='5.5.5-10.0.36-MariaDB'}
2022-08-20 21:20:28.861 [main] DEBUG DruidMonitorFilter.connection_setAutoCommit(242) - ### [开启自动提交] connThreadId 110 不自动提交
SqlSessionInfo{connectionHashCode='139098f0', connThreadId=110, localPort=54353, dataSourceName='ds2', autoCommit=false, serverIP='127.0.0.1', serverPort=3306, dbName='testdb', userName='test', serverVersion='5.5.5-10.0.36-MariaDB'}
2022-08-20 21:20:28.861 [main] DEBUG DruidMonitorFilter.dataSource_releaseConnection(109) - ### [归还连接至连接池] connThreadId 110 自动提交 当前连接SQL语句执行次数: 0
SqlSessionInfo{connectionHashCode='139098f0', connThreadId=110, localPort=54353, dataSourceName='ds2', autoCommit=true, serverIP='127.0.0.1', serverPort=3306, dbName='testdb', userName='test', serverVersion='5.5.5-10.0.36-MariaDB'}
